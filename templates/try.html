<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ultra WhatsApp ‚Äî Single File</title>
  <style>
    :root{
      --bg:#0b141a;
      --panel:#111b21;
      --panel-2:#202c33;
      --accent:#00a884;
      --text:#e9edef;
      --muted:#8696a0;
      --bubble-me:#005c4b;
      --bubble-them:#1f2c34;
      --divider:#2a3942;
      --scroll:#2a3942;
    }
    [data-theme="light"]{
      --bg:#ece5dd;
      --panel:#ffffff;
      --panel-2:#f0f2f5;
      --accent:#25d366;
      --text:#111b21;
      --muted:#667781;
      --bubble-me:#d9fdd3;
      --bubble-them:#ffffff;
      --divider:#e9edef;
      --scroll:#d1d7db;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;
      background:var(--bg);
      color:var(--text);
      overflow:hidden;
    }
    .app{
      height:100vh;
      display:grid;
      grid-template-columns: 380px 1fr;
      background: linear-gradient(180deg, rgba(0,0,0,0.12) 0 20%, transparent 20% 100%), var(--bg);
    }
    .sidebar{
      display:flex;
      flex-direction:column;
      border-right:1px solid var(--divider);
      background:var(--panel);
    }
    .sb-header{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 16px;
      background:var(--panel-2);
      border-bottom:1px solid var(--divider);
    }
    .me{
      display:flex; align-items:center; gap:12px;
    }
    .avatar{
      width:40px; height:40px; border-radius:50%;
      background:#ccc; overflow:hidden; flex:0 0 40px;
    }
    .avatar img{width:100%; height:100%; object-fit:cover}
    .tools{display:flex; align-items:center; gap:14px; color:var(--muted)}
    .icon-btn{
      width:36px; height:36px; border-radius:50%;
      display:grid; place-items:center; cursor:pointer; user-select:none;
    }
    .icon-btn:hover{background:rgba(255,255,255,0.06)}
    .notif{
      display:flex; gap:12px; padding:10px 16px; align-items:center;
      background:#182229; color:#9de1fe; border-bottom:1px solid var(--divider);
    }
    .search{
      position:relative; padding:8px 12px; background:var(--panel);
      border-bottom:1px solid var(--divider);
    }
    .search input{
      width:100%; padding:10px 40px 10px 42px; border:none; outline:none;
      border-radius:8px; background:var(--panel-2); color:var(--text);
    }
    .search .glass{
      position:absolute; top:50%; left:24px; transform:translateY(-50%); color:var(--muted);
    }
    .chats{
      overflow:auto; flex:1;
      scrollbar-color: var(--scroll) transparent;
      scrollbar-width: thin;
    }
    .chat-item{
      display:flex; gap:12px; padding:10px 16px; cursor:pointer;
      border-bottom:1px solid var(--divider);
    }
    .chat-item:hover{background:rgba(255,255,255,0.03)}
    .chat-meta{flex:1; min-width:0}
    .chat-row{
      display:flex; justify-content:space-between; align-items:center;
    }
    .chat-name{
      font-weight:600; color:var(--text); overflow:hidden; white-space:nowrap; text-overflow:ellipsis;
    }
    .chat-time{color:var(--muted); font-size:12px}
    .chat-preview{
      color:var(--muted); font-size:14px; overflow:hidden; white-space:nowrap; text-overflow:ellipsis;
    }
    .unread .chat-time{color:var(--accent)}
    .main{
      display:flex; flex-direction:column; background:var(--panel-2);
    }
    .conv-header{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 16px; background:var(--panel-2); border-bottom:1px solid var(--divider);
    }
    .conv-peer{display:flex; align-items:center; gap:12px; min-width:0}
    .peer-info{min-width:0}
    .peer-name{font-weight:600; overflow:hidden; text-overflow:ellipsis; white-space:nowrap}
    .peer-status{color:var(--muted); font-size:12px}
    .board-wrap{
      position:relative; flex:1; overflow:auto; background:
        linear-gradient(#0b141a 0 0) padding-box,
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="512" height="512"><defs><pattern id="p" width="64" height="64" patternUnits="userSpaceOnUse"><circle cx="2" cy="2" r="2" fill="%232a3942"/></pattern></defs><rect width="100%" height="100%" fill="transparent"/><rect width="100%" height="100%" fill="url(%23p)"/></svg>') center/256px repeat;
      scrollbar-color: var(--scroll) transparent; scrollbar-width: thin;
      padding:24px 16px 12px;
    }
    .day-divider{
      display:inline-block; padding:6px 12px; border-radius:999px;
      background:rgba(0,0,0,0.2); color:var(--text); font-size:12px; margin:0 auto 12px;
    }
    .msg{
      max-width:min(70%, 720px);
      padding:8px 10px 6px 10px; border-radius:12px; margin:6px 0;
      position:relative; color:var(--text); line-height:1.35;
      box-shadow:0 1px 0 rgba(0,0,0,0.15);
    }
    .from-me{
      background:var(--bubble-me); margin-left:auto; border-top-right-radius:4px;
    }
    .from-them{
      background:var(--bubble-them); margin-right:auto; border-top-left-radius:4px;
    }
    .tail:after{
      content:""; position:absolute; bottom:0; width:12px; height:12px;
      background:inherit; clip-path: polygon(100% 0, 0 100%, 100% 100%);
    }
    .from-me.tail:after{ right:-4px; transform:skewX(-8deg) translateY(-2px); }
    .from-them.tail:after{ left:-4px; transform:skewX(8deg) translateY(-2px); }
    .meta{
      display:inline-flex; gap:6px; align-items:center; color:var(--muted);
      font-size:11px; margin-left:8px;
    }
    .input-bar{
      display:flex; align-items:center; gap:8px; padding:8px 12px;
      background:var(--panel-2); border-top:1px solid var(--divider);
    }
    .compose{
      flex:1; display:flex; align-items:center; gap:8px;
      background:var(--panel); border-radius:8px; padding:6px 10px;
    }
    .compose input{
      flex:1; border:none; outline:none; background:transparent; color:var(--text);
      padding:8px 6px;
    }
    .send{
      background:var(--accent); color:#fff; border:none; border-radius:8px;
      padding:10px 14px; cursor:pointer;
    }
    .send:active{transform:translateY(1px)}
    .pill{
      display:inline-block; padding:2px 8px; border-radius:999px;
      font-size:11px; background:var(--accent); color:#0b141a;
    }
    .hidden{display:none !important}
    /* Responsive */
    @media (max-width: 980px){
      .app{grid-template-columns: 1fr}
      .sidebar{position:absolute; z-index:3; width:100%; max-width:420px; height:100vh; transform:translateX(0); transition:.25s ease}
      .sidebar.hidden{transform:translateX(-100%)}
      .main{z-index:2}
    }
  </style>
</head>
<body data-theme="dark">
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sb-header">
        <div class="me">
          <div class="avatar"><img alt="me" src="https://i.pravatar.cc/100?img=13"/></div>
          <div>
            <div style="font-weight:600">Alex</div>
            <div style="font-size:12px; color:var(--muted)">online</div>
          </div>
        </div>
        <div class="tools">
          <div class="icon-btn" title="Status">‚óé</div>
          <div class="icon-btn" title="New chat">‚úö</div>
          <div class="icon-btn" title="Menu" id="toggleTheme">‚òº</div>
        </div>
      </div>

      <div class="notif">
        <div class="icon-btn" style="background:#53bdeb;color:#0b141a;font-weight:700">i</div>
        <div style="font-size:14px">
          Get notified of new messages ‚Äî enable desktop notifications
        </div>
      </div>

      <div class="search">
        <span class="glass">üîé</span>
        <input id="chatSearch" placeholder="Search or start new chat" />
      </div>

      <div class="chats" id="chatList">
        <!-- Chats injected by JS -->
      </div>
    </aside>

    <!-- Main conversation -->
    <main class="main">
      <div class="conv-header">
        <div class="conv-peer">
          <div class="icon-btn" id="backToList" title="Back" style="display:none">‚Üê</div>
          <div class="avatar" id="peerAvatar"></div>
          <div class="peer-info">
            <div class="peer-name" id="peerName">Select a chat</div>
            <div class="peer-status" id="peerStatus">No messages yet</div>
          </div>
        </div>
        <div class="tools">
          <div class="icon-btn" title="Search in chat">üîç</div>
          <div class="icon-btn" title="Calls">üìû</div>
          <div class="icon-btn" title="More">‚ãÆ</div>
        </div>
      </div>

      <div class="board-wrap" id="board">
        <div class="day-divider" id="dayDivider">Today</div>
        <!-- Messages injected by JS -->
      </div>

      <div class="input-bar">
        <div class="compose">
          <div class="icon-btn" id="emojiBtn" title="Emoji">üòä</div>
          <input id="messageInput" placeholder="Type a message" />
          <div class="icon-btn" title="Attach">üìé</div>
          <div class="icon-btn" title="Mic">üé§</div>
        </div>
        <button class="send" id="sendBtn">Send</button>
      </div>
    </main>
  </div>

  <script>
    // Mock data
    const chats = [
      {
        id: 'c1', name: 'Jordan', avatar: 'https://i.pravatar.cc/100?img=5',
        preview: 'Are we still on for tomorrow?', time: '10:02',
        unread: 2,
        messages: [
          {from:'them', text:'Hey! Meeting at 10?', time:'09:58'},
          {from:'me', text:'Sure, see you there.', time:'10:00'},
          {from:'them', text:'Are we still on for tomorrow?', time:'10:02'},
        ]
      },
      {
        id: 'c2', name: 'Team Design', avatar: 'https://i.pravatar.cc/100?img=32',
        preview: 'Shared the Figma link.', time: '09:21',
        unread: 0,
        messages: [
          {from:'them', text:'Shared the Figma link.', time:'09:21'},
          {from:'me', text:'Got it, thanks!', time:'09:22'},
        ]
      },
      {
        id: 'c3', name: 'Maya', avatar: 'https://i.pravatar.cc/100?img=47',
        preview: 'Lunch today?', time: '08:05',
        unread: 1,
        messages: [
          {from:'them', text:'Lunch today?', time:'08:05'},
        ]
      },
      {
        id: 'c4', name: 'Dev Squad', avatar: 'https://i.pravatar.cc/100?img=15',
        preview: 'Pushed the hotfix.', time: 'Yesterday',
        unread: 0,
        messages: [
          {from:'them', text:'Pushed the hotfix.', time:'17:41'},
          {from:'me', text:'Deployed to staging.', time:'17:55'},
          {from:'them', text:'QA is green.', time:'18:12'},
        ]
      }
    ];

    // Elements
    const chatList = document.getElementById('chatList');
    const chatSearch = document.getElementById('chatSearch');
    const peerAvatar = document.getElementById('peerAvatar');
    const peerName = document.getElementById('peerName');
    const peerStatus = document.getElementById('peerStatus');
    const board = document.getElementById('board');
    const messageInput = document.getElementById('messageInput');
    const sendBtn = document.getElementById('sendBtn');
    const toggleTheme = document.getElementById('toggleTheme');
    const sidebar = document.getElementById('sidebar');
    const backToList = document.getElementById('backToList');

    let currentChatId = null;
    let theme = 'dark';

    function renderChatList(filter=''){
      chatList.innerHTML = '';
      const q = filter.trim().toLowerCase();
      chats
        .filter(c => !q || c.name.toLowerCase().includes(q) || c.preview.toLowerCase().includes(q))
        .forEach(c => {
          const item = document.createElement('div');
          item.className = 'chat-item' + (c.unread ? ' unread':'');
          item.dataset.id = c.id;
          item.innerHTML = `
            <div class="avatar"><img src="${c.avatar}" alt="${c.name}"/></div>
            <div class="chat-meta">
              <div class="chat-row">
                <div class="chat-name">${c.name}</div>
                <div class="chat-time">${c.time}</div>
              </div>
              <div class="chat-row" style="gap:8px">
                <div class="chat-preview">${c.preview}</div>
                ${c.unread ? `<span class="pill">${c.unread}</span>` : ''}
              </div>
            </div>
          `;
          item.addEventListener('click', () => openChat(c.id));
          chatList.appendChild(item);
        });
    }

    function openChat(id){
      currentChatId = id;
      const c = chats.find(x => x.id === id);
      if(!c) return;
      // Clear unread
      c.unread = 0;
      renderChatList(chatSearch.value);

      // Header
      peerAvatar.innerHTML = `<img alt="${c.name}" src="${c.avatar}" />`;
      peerName.textContent = c.name;
      peerStatus.textContent = 'online';

      // Messages
      board.innerHTML = `<div class="day-divider">Today</div>`;
      c.messages.forEach(m => {
        const div = document.createElement('div');
        const side = m.from === 'me' ? 'from-me' : 'from-them';
        div.className = `msg ${side} tail`;
        div.innerHTML = `
          <span>${escapeHtml(m.text)}</span>
          <span class="meta">${m.time}</span>
        `;
        board.appendChild(div);
      });
      board.scrollTop = board.scrollHeight;

      // Mobile UX
      if (window.innerWidth <= 980){
        sidebar.classList.add('hidden');
        backToList.style.display = 'inline-grid';
      }
    }

    function sendMessage(){
      const text = messageInput.value.trim();
      if(!text || !currentChatId) return;
      const c = chats.find(x => x.id === currentChatId);
      if(!c) return;

      // Push my message
      const time = formatTime(new Date());
      c.messages.push({from:'me', text, time});
      c.preview = text;
      c.time = time;

      const node = document.createElement('div');
      node.className = 'msg from-me tail';
      node.innerHTML = `<span>${escapeHtml(text)}</span><span class="meta">${time}</span>`;
      board.appendChild(node);
      board.scrollTop = board.scrollHeight;

      messageInput.value = '';

      // Simulate reply
      setTimeout(() => {
        const replyText = autoReply(text);
        const rtime = formatTime(new Date());
        c.messages.push({from:'them', text: replyText, time: rtime});
        c.preview = replyText;
        c.time = rtime;

        // Show if still in same chat
        if(currentChatId === c.id){
          const reply = document.createElement('div');
          reply.className = 'msg from-them tail';
          reply.innerHTML = `<span>${escapeHtml(replyText)}</span><span class="meta">${rtime}</span>`;
          board.appendChild(reply);
          board.scrollTop = board.scrollHeight;
        } else {
          c.unread = (c.unread || 0) + 1;
          renderChatList(chatSearch.value);
        }
      }, 600);
    }

    function escapeHtml(s){
      return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }
    function formatTime(d){
      const hh = String(d.getHours()).padStart(2,'0');
      const mm = String(d.getMinutes()).padStart(2,'0');
      return `${hh}:${mm}`;
    }
    function autoReply(text){
      const lower = text.toLowerCase();
      if (lower.includes('hi') || lower.includes('hello')) return 'Hello! üëã';
      if (lower.includes('time')) return 'Anytime after 3 PM works for me.';
      if (lower.includes('link')) return 'Here you go: figma.com/file/xyz';
      if (lower.includes('ok') || lower.includes('okay')) return 'Great!';
      return 'Sounds good.';
    }

    // Search
    chatSearch.addEventListener('input', e => renderChatList(e.target.value));

    // Send handlers
    sendBtn.addEventListener('click', sendMessage);
    messageInput.addEventListener('keydown', e => {
      if (e.key === 'Enter' && !e.shiftKey){
        e.preventDefault();
        sendMessage();
      }
    });

    // Theme toggle
    toggleTheme.addEventListener('click', () => {
      theme = theme === 'dark' ? 'light' : 'dark';
      document.body.setAttribute('data-theme', theme);
    });

    // Emoji stub
    document.getElementById('emojiBtn').addEventListener('click', () => {
      messageInput.value += ' üôÇ';
      messageInput.focus();
    });

    // Back to list (mobile)
    backToList.addEventListener('click', () => {
      sidebar.classList.remove('hidden');
      backToList.style.display = 'none';
    });

    // Initial render
    renderChatList();
  </script>
</body>
</html>